---
import { handleI18nSlug } from "@astrolicious/i18n/content-collections"
import { Picture } from "astro:assets"
import { getLocale, getLocalePath, t } from "i18n:astro"
import { Calendar1, ChevronRight, Tag, UserPen } from "lucide-react"

type Props = {
	title: string
	description: string
	date: Date
	author: string
	image: ImageMetadata
	imageAlt: string
	id: string
	tag?: string
}

const locale = getLocale()

const { title, description, date, author, image, imageAlt, id, tag }: Props = Astro.props

const { slug: localizedId } = handleI18nSlug(id)
---

<li class="flex flex-col gap-y-4 rounded-xl border bg-muted/30">
	<a href={getLocalePath(`/blog/${localizedId}`)}>
		<Picture
			src={image}
			alt={imageAlt}
			widths={[240, 480, 720]}
			sizes="(max-width: 640px) 240px, (max-width: 1024px) 480px, 720px"
			formats={["webp"]}
			loading="lazy"
			decoding="async"
			quality="mid"
			class="rounded-t-xl object-contain transition-opacity duration-150 ease-out hover:opacity-75"
		/>
	</a>

	<div class="flex h-full flex-col gap-y-2 px-6 pb-4">
		<a href={getLocalePath(`/blog/${localizedId}`)}>
			<h3 class="text-xl font-bold transition-colors duration-150 ease-out hover:text-primary">{title}</h3>
		</a>

		<div class="flex w-full flex-row flex-wrap gap-x-4 gap-y-2 text-muted-foreground">
			<span class="flex items-center gap-x-2">
				<UserPen />
				<p>{author}</p>
			</span>
			<span class="flex items-center gap-x-2">
				<Calendar1 />
				<p>{date.toLocaleDateString(locale)}</p>
			</span>
			{
				tag && (
					<span class="flex items-center gap-x-2">
						<Tag />
						<p>{tag}</p>
					</span>
				)
			}
		</div>

		<div class="flex h-full flex-col justify-between gap-y-4">
			<p>{description}</p>

			<a href={getLocalePath(`/blog/${localizedId}`)} class="w-fit">
				<span class="group flex flex-row items-center gap-x-0.5">
					{t("blogpost.read_more")}
					<ChevronRight className="transition-transform duration-150 ease-out group-hover:translate-x-1/3" />
				</span>
			</a>
		</div>
	</div>
</li>
